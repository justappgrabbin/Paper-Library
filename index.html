<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üìö PAPER Library Manager</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìö PAPER Library Manager</h1>
            <p>Consciousness-Aware App & Knowledge Organization System</p>
        </div>
        
        <div class="tab-bar">
            <button class="tab-btn active" data-tab="apps" onclick="app.switchTab('apps')">
                üì± Apps Library
            </button>
            <button class="tab-btn" data-tab="knowledge" onclick="app.switchTab('knowledge')">
                üìñ Knowledge Library
            </button>
        </div>
        
        <!-- Apps Tab Content -->
        <div class="tab-content active" id="appsTab">
        <div class="main-grid">
            <div class="upload-panel">
                <div class="drop-zone" id="dropZone">
                    <div class="drop-icon">üìÅ</div>
                    <div class="drop-text">Drop files or folders here</div>
                    <div class="drop-hint">Supports: HTML, JS, Python, TypeScript, ZIP archives</div>
                    <input type="file" id="fileInput" multiple style="display: none;" 
                           accept=".html,.js,.py,.ts,.tsx,.jsx,.css,.json,.md,.zip">
                </div>
                
                <div class="llama-status offline" id="llamaStatus">
                    <div class="status-indicator">
                        <div class="status-dot" id="statusDot"></div>
                        <span id="statusText">LlamaFile: Checking...</span>
                    </div>
                    <div style="margin-top: 10px; font-size: 0.85em; color: #6c757d;">
                        Make sure LlamaFile is running on port 8080
                    </div>
                </div>
                
                <div class="settings-section">
                    <h3>‚öôÔ∏è Settings</h3>
                    <div class="setting-row">
                        <label>LlamaFile Endpoint</label>
                        <input type="text" id="llamaEndpoint" value="http://localhost:8080">
                    </div>
                    <div class="setting-row">
                        <label>
                            <input type="checkbox" id="autoAnalyze" checked style="width: auto; margin-right: 5px;">
                            Auto-analyze with AI
                        </label>
                    </div>
                    <div class="setting-row">
                        <label>
                            <input type="checkbox" id="deepAnalysis" style="width: auto; margin-right: 5px;">
                            Deep analysis (slower, more accurate)
                        </label>
                    </div>
                </div>
                
                <div class="processing-log" id="processingLog" style="display: none;"></div>
            </div>
            
            <div class="stats-panel">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="totalApps">0</div>
                        <div class="stat-label">Total Apps</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="energeticApps">0</div>
                        <div class="stat-label">‚ö° Energetic</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="flowingApps">0</div>
                        <div class="stat-label">„Ä∞Ô∏è Flowing</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="calmApps">0</div>
                        <div class="stat-label">üåä Calm</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="focusedApps">0</div>
                        <div class="stat-label">üî• Focused</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="spiralApps">0</div>
                        <div class="stat-label">üåÄ Spiral</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="library-section">
            <div class="section-header">
                <h2>üìñ Your Library</h2>
                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="app.clearLibrary()">üóëÔ∏è Clear All</button>
                    <button class="btn btn-secondary" onclick="app.importLibrary()">üì• Import JSON</button>
                    <button class="btn btn-primary" onclick="app.exportLibrary()">üíæ Export JSON</button>
                </div>
            </div>
            
            <div class="filter-bar">
                <div class="filter-group">
                    <label>Filter by energy:</label>
                    <button class="filter-btn active" data-filter="all" onclick="app.filterLibrary('all')">All</button>
                    <button class="filter-btn" data-filter="energetic" onclick="app.filterLibrary('energetic')">‚ö° Energetic</button>
                    <button class="filter-btn" data-filter="flowing" onclick="app.filterLibrary('flowing')">„Ä∞Ô∏è Flowing</button>
                    <button class="filter-btn" data-filter="calm" onclick="app.filterLibrary('calm')">üåä Calm</button>
                    <button class="filter-btn" data-filter="focused" onclick="app.filterLibrary('focused')">üî• Focused</button>
                    <button class="filter-btn" data-filter="spiral" onclick="app.filterLibrary('spiral')">üåÄ Spiral</button>
                </div>
                <div class="search-group">
                    <input type="text" id="searchInput" placeholder="Search apps..." onkeyup="app.searchLibrary()">
                </div>
            </div>
            
            <div class="library-grid" id="libraryGrid">
                <div class="empty-state">
                    <div class="empty-state-icon">üìö</div>
                    <h3>Your library is empty</h3>
                    <p>Drop some files above to get started!</p>
                </div>
            </div>
        </div>
        </div>
        
        <!-- Knowledge Tab Content -->
        <div class="tab-content" id="knowledgeTab">
            <div class="main-grid">
                <div class="upload-panel">
                    <div class="drop-zone" id="bookDropZone">
                        <div class="drop-icon">üìñ</div>
                        <div class="drop-text">Drop books or documents here</div>
                        <div class="drop-hint">Supports: PDF, EPUB, TXT, MD</div>
                        <input type="file" id="bookInput" multiple style="display: none;" 
                               accept=".pdf,.epub,.txt,.md">
                    </div>
                    
                    <div class="settings-section">
                        <h3>üìä Extraction Settings</h3>
                        <div class="setting-row">
                            <label>
                                <input type="checkbox" id="extractGates" checked style="width: auto; margin-right: 5px;">
                                Extract Gate/Line references
                            </label>
                        </div>
                        <div class="setting-row">
                            <label>
                                <input type="checkbox" id="extractQuantum" checked style="width: auto; margin-right: 5px;">
                                Extract quantum mechanics concepts
                            </label>
                        </div>
                        <div class="setting-row">
                            <label>
                                <input type="checkbox" id="extractDimensions" checked style="width: auto; margin-right: 5px;">
                                Extract dimensional references
                            </label>
                        </div>
                    </div>
                    
                    <div class="processing-log" id="knowledgeLog" style="display: none;"></div>
                </div>
                
                <div class="stats-panel">
                    <h3 style="margin-bottom: 15px; color: #667eea;">üìö Knowledge Stats</h3>
                    <div class="stats-grid" style="grid-template-columns: repeat(2, 1fr);">
                        <div class="stat-card">
                            <div class="stat-number" id="totalBooks">0</div>
                            <div class="stat-label">Books</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="totalInsights">0</div>
                            <div class="stat-label">Insights</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="totalGates">0</div>
                            <div class="stat-label">Gates Referenced</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="totalConcepts">0</div>
                            <div class="stat-label">Concepts</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="library-section">
                <div class="section-header">
                    <h2>üîç Query Knowledge</h2>
                    <div class="action-buttons">
                        <button class="btn btn-secondary" onclick="knowledge.clearKnowledge()">üóëÔ∏è Clear All</button>
                        <button class="btn btn-primary" onclick="knowledge.exportKnowledge()">üíæ Export JSON</button>
                    </div>
                </div>
                
                <div class="query-bar">
                    <div class="query-group">
                        <label>Search by Gate:</label>
                        <select id="gateSelect" onchange="knowledge.filterByGate()">
                            <option value="">All Gates</option>
                        </select>
                    </div>
                    <div class="query-group">
                        <label>Search by Line:</label>
                        <select id="lineSelect" onchange="knowledge.filterByLine()">
                            <option value="">All Lines</option>
                            <option value="1">Line 1</option>
                            <option value="2">Line 2</option>
                            <option value="3">Line 3</option>
                            <option value="4">Line 4</option>
                            <option value="5">Line 5</option>
                            <option value="6">Line 6</option>
                        </select>
                    </div>
                    <div class="query-group">
                        <input type="text" id="conceptSearch" placeholder="Search concepts..." onkeyup="knowledge.searchConcepts()">
                    </div>
                </div>
                
                <div class="knowledge-grid" id="knowledgeGrid">
                    <div class="empty-state">
                        <div class="empty-state-icon">üìñ</div>
                        <h3>Knowledge library is empty</h3>
                        <p>Upload books or documents to extract wisdom!</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Edit Modal -->
    <div class="modal" id="editModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Edit App Details</h2>
                <button class="close-modal" onclick="app.closeEditModal()">√ó</button>
            </div>
            <form id="editForm" onsubmit="app.saveEdit(event)">
                <div class="form-group">
                    <label>App Name</label>
                    <input type="text" id="editName" required>
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <textarea id="editDescription"></textarea>
                </div>
                <div class="form-group">
                    <label>Energy Signature</label>
                    <div class="glyph-selector">
                        <div class="glyph-option" data-energy="energetic" onclick="app.selectEnergy('energetic')">
                            ‚ö° Energetic<br><small>Dynamic, intense</small>
                        </div>
                        <div class="glyph-option" data-energy="flowing" onclick="app.selectEnergy('flowing')">
                            „Ä∞Ô∏è Flowing<br><small>Adaptive, rhythmic</small>
                        </div>
                        <div class="glyph-option" data-energy="calm" onclick="app.selectEnergy('calm')">
                            üåä Calm<br><small>Gentle, peaceful</small>
                        </div>
                        <div class="glyph-option" data-energy="focused" onclick="app.selectEnergy('focused')">
                            üî• Focused<br><small>Structured, precise</small>
                        </div>
                        <div class="glyph-option" data-energy="spiral" onclick="app.selectEnergy('spiral')">
                            üåÄ Spiral<br><small>Recursive, transformative</small>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label>Tags (comma-separated)</label>
                    <input type="text" id="editTags" placeholder="meditation, timer, focus">
                </div>
                <div class="form-group">
                    <label>Best for (consciousness types)</label>
                    <input type="text" id="editBestFor" placeholder="Manifestors, Projectors, analytical minds">
                </div>
                <div class="action-buttons" style="margin-top: 20px;">
                    <button type="button" class="btn btn-secondary" onclick="app.closeEditModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Changes</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Import Modal -->
    <input type="file" id="importInput" accept=".json" style="display: none;">
    
    <script src="library.js"></script>
    <script src="parser.js"></script>
    <script src="analyzer.js"></script>
    <script src="knowledge.js"></script>
    <script src="app.js"></script>
</body>
</html>
